
<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>WorkConnect</title>
<link rel="stylesheet" href="style.css"/>
</head>
<body>

<div class="split-bg"></div>
<div class="middle-line"></div>
<div class="logo"><img src="logo.jpg" alt="WorkConnect Logo"></div>

<div class="side" id="left">
    <div class="side-content">
        <div class="side-title">Munkavállaló</div>
        <div class="info-box">
            <ul>
                <li>User‑friendly felület</li>
                <li>100+ állásajánlat</li>
                <li>Gyors és egyszerű keresés</li>
            </ul>
        </div>
        <button class="side-btn" data-user-type="employee">Belépés</button>
    </div>
</div>

<div class="side" id="right">
    <div class="side-content">
        <div class="side-title">Munkáltató</div>
        <div class="info-box">
            <ul>
                <li>Egyszerű hirdetésfeladás</li>
                <li>Gyors elérés a munkakeresők között</li>
                <li>Modern kezelőfelület</li>
            </ul>
        </div>
        <button class="side-btn" data-user-type="employer">Belépés</button>
    </div>
</div>

<div class="footer-wrapper">
    <div class="footer-content">
        <p>Company Name • Address • Contact Info</p>
        <p>Links | Privacy | Terms</p>
    </div>
</div>


<div id="loginModal" class="login-modal">
    <div class="login-modal-content">
        <div class="login-modal-header">
            <h3 id="loginTitle">Bejelentkezés - <span id="userTypeText">Munkavállaló</span></h3>
            <span class="login-close-btn">&times;</span>
        </div>
        <div class="login-modal-body">
     
            <form id="loginForm" class="login-form active">
                <div class="form-group">
                    <label for="loginUsername">Felhasználónév:</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Jelszó:</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="login-btn">Bejelentkezés</button>
                    <button type="button" class="switch-form-btn" id="showRegister">Regisztráció</button>
                </div>
                <div id="loginMessage" class="message"></div>
            </form>
            
        
            <form id="registerForm" class="login-form">
                <div class="form-group">
                    <label for="registerUsername">Felhasználónév:</label>
                    <input type="text" id="registerUsername" required minlength="3">
                    <small class="hint">Minimum 3 karakter</small>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Jelszó:</label>
                    <input type="password" id="registerPassword" required minlength="4">
                    <small class="hint">Minimum 4 karakter</small>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Jelszó megerősítése:</label>
                    <input type="password" id="confirmPassword" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="login-btn">Regisztráció</button>
                    <button type="button" class="switch-form-btn" id="showLogin">Vissza a bejelentkezéshez</button>
                </div>
                <div id="registerMessage" class="message"></div>
            </form>
        </div>
    </div>
</div>

<script src="auth.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Index oldal betöltődött');

    let currentUserType = 'employee';
    
    // Belépés gombok kezelése
    const buttons = document.querySelectorAll('.side-btn');
    buttons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
            currentUserType = this.getAttribute('data-user-type');
            const userTypeText = currentUserType === 'employee' ? 'Munkavállaló' : 'Munkáltató';
            
            document.getElementById('userTypeText').textContent = userTypeText;

            localStorage.setItem('selectedUserType', currentUserType);
            
            document.getElementById('loginModal').classList.add('open');
            document.body.classList.add('modal-open');
        });
    });
    
    // Oldalra kattintás - CSAK HA NINCS BEJELENTKEZVE
    const leftSide = document.getElementById('left');
    const rightSide = document.getElementById('right');
    
    [leftSide, rightSide].forEach(side => {
        side.addEventListener('click', function(e) {
            if (e.target === side) {
                // Ellenőrizzük, hogy be van-e jelentkezve
                const isLoggedIn = () => {
                    return localStorage.getItem('currentUser') !== null;
                };
                
                if (!isLoggedIn()) {
                    // Ha nincs bejelentkezve, csak mutassuk a modal-t
                    const userType = side.id === 'left' ? 'employee' : 'employer';
                    currentUserType = userType;
                    const userTypeText = userType === 'employee' ? 'Munkavállaló' : 'Munkáltató';
                    
                    document.getElementById('userTypeText').textContent = userTypeText;
                    localStorage.setItem('selectedUserType', userType);
                    
                    document.getElementById('loginModal').classList.add('open');
                    document.body.classList.add('modal-open');
                }
                // Ha be van jelentkezve, NE tegyünk semmit - a felhasználó kattintson a belépés gombra
            }
        });
    });
    
    // Modal bezárás
    const loginModal = document.getElementById('loginModal');
    const closeBtn = document.querySelector('.login-close-btn');
    
    if (closeBtn) {
        closeBtn.addEventListener('click', function() {
            loginModal.classList.remove('open');
            document.body.classList.remove('modal-open');
        });
    }
    
    // Modal bezárás kattintással a háttérre
    let isDragging = false;
    let dragStartX = 0;
    let dragStartY = 0;
    const DRAG_THRESHOLD = 5;
    
    loginModal.addEventListener('mousedown', function(e) {
        if (e.target === loginModal) {
            isDragging = false;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
        }
    });
    
    loginModal.addEventListener('mousemove', function(e) {
        if (e.target === loginModal && (dragStartX !== 0 || dragStartY !== 0)) {
            const deltaX = Math.abs(e.clientX - dragStartX);
            const deltaY = Math.abs(e.clientY - dragStartY);
            
            if (deltaX > DRAG_THRESHOLD || deltaY > DRAG_THRESHOLD) {
                isDragging = true;
            }
        }
    });
    
    loginModal.addEventListener('mouseup', function(e) {
        if (e.target === loginModal && !isDragging) {
            loginModal.classList.remove('open');
            document.body.classList.remove('modal-open');
        }
        
        // Reset
        isDragging = false;
        dragStartX = 0;
        dragStartY = 0;
    });
    
    // Touch események
    let touchStartX = 0;
    let touchStartY = 0;
    let isTouchDragging = false;
    
    loginModal.addEventListener('touchstart', function(e) {
        if (e.target === loginModal) {
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
            isTouchDragging = false;
        }
    }, { passive: true });
    
    loginModal.addEventListener('touchmove', function(e) {
        if (e.target === loginModal && (touchStartX !== 0 || touchStartY !== 0)) {
            const touch = e.touches[0];
            const deltaX = Math.abs(touch.clientX - touchStartX);
            const deltaY = Math.abs(touch.clientY - touchStartY);
            
            if (deltaX > DRAG_THRESHOLD || deltaY > DRAG_THRESHOLD) {
                isTouchDragging = true;
            }
        }
    }, { passive: true });
    
    loginModal.addEventListener('touchend', function(e) {
        if (e.target === loginModal && !isTouchDragging) {
            loginModal.classList.remove('open');
            document.body.classList.remove('modal-open');
        }
        
        // Reset
        isTouchDragging = false;
        touchStartX = 0;
        touchStartY = 0;
    });
    
    // Form váltás
    const showRegisterBtn = document.getElementById('showRegister');
    const showLoginBtn = document.getElementById('showLogin');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    
    if (showRegisterBtn) {
        showRegisterBtn.addEventListener('click', function() {
            loginForm.classList.remove('active');
            registerForm.classList.add('active');
        });
    }
    
    if (showLoginBtn) {
        showLoginBtn.addEventListener('click', function() {
            registerForm.classList.remove('active');
            loginForm.classList.add('active');
        });
    }
    
    // Inputok kattintásának kezelése (ne zárja be a modalt)
    const inputs = document.querySelectorAll('.login-modal input');
    inputs.forEach(input => {
        input.addEventListener('mousedown', function(e) {
            e.stopPropagation();
        });
        
        input.addEventListener('touchstart', function(e) {
            e.stopPropagation();
        }, { passive: true });
    });
    
    // FONTOS: NE IRÁNYÍTSUNK AUTOMATIKUSAN AZ INDEX.HTML-RŐL!
    // Ezt távolítottuk el, mert ez okozta a loop-ot
    console.log('Index oldal készen áll, nincs automatikus átirányítás');
});
</script>

</body>
</html>
