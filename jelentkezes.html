<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="favicon.ico">
    <title>Jelentkez√©s - WorkConnect</title>
</head>
<body class="jobs-page">

    <!-- Fels≈ë s√°v -->
    <div class="jobs-topbar">
        <div class="jobs-hamburger">‚ò∞</div>
        <div class="jobs-timer">
            <span class="timer-text">05:00</span>
        </div>
        <a href="profile.html" class="jobs-profile-circle"></a>
    </div>

    <!-- Oldals√≥ men√º -->
    <div class="sidebar-menu">
        <button class="close-btn">√ó</button>
        <h3>Men√º</h3>
        <ul>
            <li><a href="index.html">F≈ëoldal</a></li>
            <li><a href="premium.html">Premium</a></li>
            <li><a href="profile.html">Profil</a></li>
            <li><a href="#">Be√°ll√≠t√°sok</a></li>
            <li><a href="#" id="logoutBtnSidebar">Kijelentkez√©s</a></li>
        </ul>
    </div>

    <!-- F≈ë tartalom -->
    <div class="application-container">
        <a href="jobs.html" class="back-button">Vissza az √°ll√°sokhoz</a>
        
        <div class="application-header">
            <h1>Jelentkez√©s</h1>
            <p>T√∂ltsd ki az al√°bbi ≈±rlapot a jelentkez√©shez</p>
        </div>
        
        <div class="form-section">
            <form action="" method="post" id="signup">
                <div class="field">
                    <label for="name" class="required">Teljes n√©v:</label>
                    <input type="text" id="name" name="name" placeholder="Add meg a neved" required />
                    <small class="error-message"></small>
                </div>
                
                <div class="field">
                    <label for="email" class="required">Email c√≠m:</label>
                    <input type="email" id="email" name="email" placeholder="pelda@email.com" required />
                    <small class="error-message"></small>
                </div>
                
                <div class="field">
                    <label for="phone" class="required">Telefonsz√°m:</label>
                    <input type="tel" id="phone" name="phone" placeholder="+36 30 123 4567" required />
                    <small class="error-message"></small>
                </div>
                
                <div class="field">
                    <label for="address" class="required">Lakc√≠m:</label>
                    <input type="text" id="address" name="address" placeholder="V√°ros, utca, h√°zsz√°m" required />
                    <small class="error-message"></small>
                </div>
                
                <div class="field">
                    <label class="required">Jogos√≠tv√°ny:</label>
                    <div class="license-options">
                        <label class="license-option">
                            <input type="radio" name="license" value="yes" required>
                            Van jogos√≠tv√°nyom
                        </label>
                        <label class="license-option">
                            <input type="radio" name="license" value="no" required>
                            Nincs jogos√≠tv√°nyom
                        </label>
                    </div>
                    <small class="error-message"></small>
                </div>
                
                <div class="field">
                    <label for="cv">√ñn√©letrajz (opcion√°lis):</label>
                    <input type="file" id="cv" name="cv" accept=".pdf,.doc,.docx" />
                    <small>PDF, DOC vagy DOCX form√°tum (max. 5MB)</small>
                </div>
                
                <div class="field">
                    <label for="message">Bemutatkoz√≥ lev√©l (opcion√°lis):</label>
                    <textarea id="message" name="message" rows="4" placeholder="√çrj n√©h√°ny sz√≥t magadr√≥l, tapasztalataidr√≥l..."></textarea>
                </div>
                
                <button type="submit" class="apply-submit-btn">
                    Jelentkez√©s elk√ºld√©se
                </button>
            </form>
        </div>
    </div>

    <!-- Sikeres jelentkez√©s popup -->
    <div id="successPopup" class="popup">
        <div class="popup-content">
            <h3>Jelentkez√©s√©t megkaptuk! üéâ</h3>
            <p>Emailben hamarosan √©rtes√≠tj√ºk a tov√°bbiakr√≥l.</p>
            <button onclick="closePopup()" class="buy-btn">Rendben</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Jelentkez√©s oldal bet√∂lt≈ëd√∂tt');
            
            // Auth ellen≈ërz√©s
            const isLoggedIn = () => {
                return localStorage.getItem('currentUser') !== null;
            };
            
            if (!isLoggedIn()) {
                console.log('Nincs bejelentkezve, √°tir√°ny√≠t√°s index.html-re');
                window.location.href = 'index.html';
                return;
            }
            
            // Profil ikon friss√≠t√©se
            const profileCircle = document.querySelector('.jobs-profile-circle');
            if (profileCircle) {
                const username = localStorage.getItem('currentUser');
                if (username) {
                    profileCircle.style.background = '#35bd5b';
                    profileCircle.style.color = 'white';
                    profileCircle.textContent = username.charAt(0).toUpperCase();
                    profileCircle.title = `${username} - Profil`;
                }
            }
            
            // Sidebar men√º kezel√©se
            const hamburger = document.querySelector('.jobs-hamburger');
            const sidebar = document.querySelector('.sidebar-menu');
            const closeBtn = document.querySelector('.close-btn');
            
            if (hamburger && sidebar) {
                hamburger.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    sidebar.classList.toggle('open');
                });
                
                if (closeBtn) {
                    closeBtn.addEventListener('click', function() {
                        sidebar.classList.remove('open');
                    });
                }
            }
            
            // Sidebar kijelentkez√©s
            const logoutBtnSidebar = document.getElementById('logoutBtnSidebar');
            if (logoutBtnSidebar) {
                logoutBtnSidebar.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (confirm('Biztosan ki szeretne jelentkezni?')) {
                        localStorage.removeItem('currentUser');
                        localStorage.removeItem('userType');
                        window.location.href = 'index.html';
                    }
                });
            }
            
            // Timer ind√≠t√°sa
            let timerInterval = null;
            let timeLeft = 300;
            
            function startTimer() {
                const timerElement = document.querySelector('.jobs-timer');
                if (!timerElement) return;
                
                const textElement = timerElement.querySelector('.timer-text') || timerElement;
                
                if (timerInterval) {
                    clearInterval(timerInterval);
                }
                
                timerInterval = setInterval(() => {
                    timeLeft--;
                    
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    textElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        localStorage.removeItem('currentUser');
                        localStorage.removeItem('userType');
                        window.location.href = 'index.html';
                    }
                }, 1000);
            }
            
            startTimer();
            
            // Timer kattint√°s esem√©ny
            const timerElement = document.querySelector('.jobs-timer');
            if (timerElement) {
                timerElement.addEventListener('click', function() {
                    timeLeft = 300;
                    startTimer();
                });
            }
            
            // ≈∞rlap valid√°ci√≥ √©s k√ºld√©s
            const form = document.getElementById('signup');
            const successPopup = document.getElementById('successPopup');
            
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                
                // Egyszer≈± valid√°ci√≥
                let isValid = true;
                const requiredFields = ['name', 'email', 'phone', 'address'];
                
                // T√∂r√∂ld a kor√°bbi hiba√ºzeneteket
                document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
                
                requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        field.nextElementSibling.textContent = 'K√∂telez≈ë mez≈ë!';
                        isValid = false;
                    }
                });
                
                // Email valid√°ci√≥
                const emailField = document.getElementById('email');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailField.value && !emailRegex.test(emailField.value)) {
                    emailField.nextElementSibling.textContent = '√ârv√©nytelen email c√≠m!';
                    isValid = false;
                }
                
                // Jogos√≠tv√°ny valid√°ci√≥
                const licenseSelected = document.querySelector('input[name="license"]:checked');
                if (!licenseSelected) {
                    document.querySelectorAll('.error-message')[4].textContent = 'V√°lassz egy lehet≈ës√©get!';
                    isValid = false;
                }
                
                if (isValid) {
                    // Sikeres k√ºld√©s - mutasd a popup-ot
                    successPopup.classList.add('show');
                    
                    // Jelentkez√©si statisztika n√∂vel√©se (ha employee)
                    const username = localStorage.getItem('currentUser');
                    const userType = localStorage.getItem('userType');
                    
                    if (userType === 'employee' && username) {
                        const statsKey = `user_stats_${username}`;
                        const statsJSON = localStorage.getItem(statsKey);
                        let stats = statsJSON ? JSON.parse(statsJSON) : {};
                        stats.jobsApplied = (stats.jobsApplied || 0) + 1;
                        localStorage.setItem(statsKey, JSON.stringify(stats));
                    }
                    
                    // 3 m√°sodperc ut√°n √°tir√°ny√≠t√°s az √°ll√°sokhoz
                    setTimeout(() => {
                        successPopup.classList.remove('show');
                        window.location.href = 'jobs.html';
                    }, 3000);
                }
            });
        });
        
        function closePopup() {
            document.getElementById('successPopup').classList.remove('show');
        }
    </script>

</body>
</html>